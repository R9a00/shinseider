# 事業承継・補助金申請サポートシステム - 詳細仕様書

## 1. はじめに

本ドキュメントは、事業承継者の新規事業を促進し、補助金申請を支援するシステムの詳細仕様を定義します。開発の指針として、**「信頼性の担保」「入力支援の強化」「多様なアウトプット生成」「情報収集・管理プロセスの標準化」**という4つの柱に基づき、各機能の仕様を明確にします。

## 2. 全体アーキテクチャ

*   **フロントエンド:** React
*   **バックエンド:** FastAPI (Python)
*   **データ永続化:** ファイルベース (YAML, etc.)

## 3. 機能ごとの詳細仕様

### 3.1. 補助金申請サポート機能

#### 3.1.1. 機能仕様

*   **目的:** 複雑な補助金申請プロセスを、ユーザーが状況に応じて多角的な視点から完遂できるようサポートします。
*   **UIフロー:**
    1.  ユーザーは、サポートを受けたい補助金をリストから選択します。
    2.  「シンプル」または「ガイド付き」の入力コースを選択し、事業計画の情報を入力します。
    3.  全ての入力が完了した後、「分析・生成する」ボタンをクリックします。
    4.  表示された「AIに相談」「専門家に相談」「自分で考える」の3つの選択肢から、目的のアウトプットを選び、結果を取得します。

#### 3.1.2. 補助金データ管理 (`subsidies.yaml`)

*   **目的:** 各補助金のルールを構造化データとして管理し、メンテナンス性と拡張性を確保します。
*   **データ構造:**
    *   **`metadata`:** 情報の信頼性を示すメタデータ（参照元ドキュメント名、URL、最終更新日）。
    *   **`criteria`:** 申請の必須要件。
    *   **`scoring_factors`:** 審査における加点項目。各項目に、以下のアウトプット生成用テンプレートを定義します。
        *   **`input_modes`:**
            *   `simple`: シンプルコース用の説明/プロンプト。
            *   `guided`: ガイド付きコース用の、分解された質問の配列。
        *   **`llm_prompt_template`:** (AI向け) LLMへのプロンプトを生成するためのテンプレート。
        *   **`human_consultation_point`:** (人間向け) 専門家への相談要点を記述したテンプレート。
        *   **`self_reflection_questions`:** (自分向け) 思考を深めるための問いかけリスト。

#### 3.1.3. アウトプット生成ロジック

*   バックエンドは、ユーザーの入力と、フロントエンドから指定された`target`（`ai`, `human`, `self`）に基づき、`subsidies.yaml`から適切なテンプレートを選択します。
*   選択されたテンプレートとユーザーの回答を組み合わせ、最終的なアウトプット（プロンプト、相談サマリー、自己レビューシート）を生成して返します。

### 3.2. その他の機能 (未来構想, 事業計画)

*   これらの機能は、補助金申請サポート機能と連携し、入力された情報を相互に活用できるように設計されます。

## 4. Git管理とTDDの徹底

*   **Git管理:** すべての変更はGitで管理し、適切な粒度でコミットを行います。
*   **TDD (テスト駆動開発):** 各機能の変更や新規実装を行う前に、まずテストコードを記述し、開発を進めます。
