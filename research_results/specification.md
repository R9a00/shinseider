# 事業承継・補助金申請サポートシステム - 詳細仕様書

## 1. はじめに

本ドキュメントは、事業承継者の新規事業を促進し、補助金申請を支援するシステムの詳細仕様を定義します。開発の指針として、**「信頼性の担保」「入力支援の強化」「情報収集・管理プロセスの標準化」**という3つの柱に基づき、各機能の仕様を明確にします。

## 2. 全体アーキテクチャ

*   **フロントエンド:** React (ポート: 3333)
*   **バックエンド:** FastAPI (Python, ポート: 8888)
*   **データ永続化:** ファイルベース (JSON, DOCX, TXT, YAML)

## 3. 機能ごとの詳細仕様

### 3.1. 未来構想フェーズ (Phase1)

*   **目的:** ユーザーが自身の事業構想を整理し、言語化するためのQ&A形式の診断機能。アトツギ甲子園の審査基準に沿った、より実践的な事業構想の整理と、説得力のあるWordレポートの生成を目指します。
*   **UI:** 質問と自由記述のテキストエリア、診断完了ボタン。
*   **出力:** 診断結果をWordファイルとしてダウンロード。
*   **データ連携:** 本フェーズで入力された情報は、後続の「事業計画フェーズ」や「補助金申請サポート機能」で再利用されます。

### 3.2. 補助金申請サポート機能

#### 3.2.1. 機能仕様

*   **目的:** 複雑で専門知識を要する補助金の申請プロセスを、ユーザーが安心して、かつ質の高いレベルで完遂できるようサポートします。単なる情報のレコメンドではなく、具体的な申請書作成支援に主眼を置きます。
*   **UIフロー:**
    1.  ユーザーは、サポートを受けたい補助金をリストから選択します。
    2.  （任意）選択した補助金のサポート情報の根拠（参照した公式ドキュメント、更新日時など）を確認できます。
    3.  ユーザーは、自身の知識レベルに合わせて入力方法を選択します。
        *   **シンプルコース:** 各審査項目に対し、要点を直接記述します（上級者向け）。
        *   **ガイド付きコース:** １つの審査項目が複数の簡単な質問に分解されており、それに答えていくだけで必要な要素を網羅します（初心者向け）。
    4.  入力完了後、システムは入力内容を分析し、申請書の質を向上させるための具体的なAIアドバイスを生成・表示します。

#### 3.2.2. 補助金データ管理 (`subsidies.yaml`)

*   **目的:** 各補助金のルール（要件、審査基準等）を構造化データとして管理し、メンテナンス性と拡張性を確保します。
*   **データ構造:**
    *   **`metadata`:** 補助金情報の信頼性を示すためのメタデータブロック。
        *   `source_document_name`: 参照した公式ドキュメント名（例: 令和X年度 中小企業新事業進出補助金 公募要領 Ver1.0）。
        *   `source_document_url`: 参照した公式ドキュメントのURL。
        *   `last_updated`: この情報の最終更新日。
    *   **`id`, `name`, `description`等:** 補助金の基本情報。
    *   **`criteria`:** 申請の必須要件。
    *   **`scoring_factors`:** 審査における加点項目。各項目に以下の入力モードを定義します。
        *   **`input_modes`:**
            *   `simple`: シンプルコース用の説明/プロンプト。
            *   `guided`: ガイド付きコース用の、分解された質問の配列。
    *   **`common_mistakes`:** よくある不備。
    *   **`llm_prompt_template`:** AIアドバイスを生成するためのプロンプトテンプレート。

#### 3.2.3. アドバイス生成ロジック

*   ユーザーの入力（シンプル/ガイド付き）と、`subsidies.yaml`に定義された`llm_prompt_template`を組み合わせ、具体的な改善アドバイスを生成します。
*   「ガイド付きコース」の場合、複数の回答を意味の通る一連の文章に組み立てるロジックを内包します。

### 3.3. 事業計画フェーズ (BusinessPlan)

*   **目的:** ユーザーが事業計画書を効率的に作成できるよう支援します。
*   **入力:** アトツギ甲子園の事業計画書に求められる項目を網羅した入力フォームを提供します。「未来構想フェーズ」の入力情報を引き継ぎ、再入力を最小化します。
*   **出力:** `python-docx`ライブラリを使用し、整形されたWord形式の事業計画書を生成します。

## 4. 全体タスクフローと進捗管理

*   **目的:** ユーザーが迷うことなく次のステップに進めるよう、ナビゲーションを強化します。
*   **UI:** システムのトップページは、「補助金申請サポートを受ける」をメインの導線とします。
*   **タスクフロー:**
    1.  補助金の選択
    2.  入力コース（シンプル/ガイド付き）の選択
    3.  質問への回答
    4.  AIによるアドバイスの確認
    5.  （将来）申請書ドラフトの生成
*   各機能間で入力情報をシームレスに連携させ、ユーザーの負担を軽減します。

## 5. Git管理とTDDの徹底

*   **Git管理:** すべての変更はGitで管理し、適切な粒度でコミットを行います。コミットメッセージは、変更内容が明確にわかるように記述します。
*   **TDD (テスト駆動開発):** 各機能の変更や新規実装を行う前に、まずテストコードを記述し、テストのパスを確認しながら開発を進めます。
