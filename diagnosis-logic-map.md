# 30秒診断 推奨ロジック完全マップ

## 各補助金の推奨条件一覧

### 1. アトツギ甲子園申請サポート （最優先）
```
条件: 事業承継関心 = "はい、事業承継予定者です" 
     AND 年齢 IN ["20代", "30代", "40代"]
初期スコア: 100
特別処理: リストの先頭に挿入（unshift）
```

### 2. ものづくり・商業・サービス生産性向上促進補助金
```
推奨ルート:
A) 製造業 + (IT/自動化/新製品) → スコア95
B) 情報通信業 + ITシステム導入 → スコア85  
C) 環境対応・省エネ + 重複チェック → スコア85
D) 人材育成 + 重複チェック → スコア75
E) デフォルト推奨 → スコア75

スコア調整:
- 小規模投資(100万円未満〜500万円): -10
- 大規模投資(3,000万円以上): +10
- 優先度「補助率が高い」: +10
- 優先度「採択率が高い」: -5
```

### 3. 中小企業省力化投資補助金
```
推奨ルート:
A) 製造業 + (設備投資/自動化) → スコア90
B) (設備投資/自動化) + 重複チェック → スコア90/75*
C) デフォルト推奨 → スコア70

*業界による差: [製造業,建設業,小売業,卸売業]=90, その他=75

スコア調整:
- 大規模投資(3,000万円以上): -5
- 優先度「採択率が高い」: +10
```

### 4. Go-tech事業（成長型中小企業等研究開発支援事業）
```
条件: 業界 = "情報通信業" 
     AND 取り組み IN ["新製品・サービスの開発"]
初期スコア: 95

スコア調整:
- 優先度「補助率が高い」: +10
```

### 5. 事業承継・M&A補助金
```
条件: 取り組み IN ["事業承継"]
     AND 重複チェック（"事業承継"を含む名前がない）
初期スコア: 95
```

### 6. 中小企業新事業進出補助金
```
条件: 取り組み IN ["海外展開"]
初期スコア: 90
スコア調整: なし
```

## 重複チェック機能

### ものづくり補助金の重複防止
- 環境対応ルート: `!recommendations.some(r => r.name.includes('ものづくり'))`
- 人材育成ルート: `!recommendations.some(r => r.name.includes('ものづくり'))`

### 省力化補助金の重複防止
- 一般ルート: `!recommendations.some(r => r.name.includes('省力化'))`

### 事業承継補助金の重複防止
- `!recommendations.some(r => r.name.includes('事業承継'))`

## 最終処理フロー

1. **重複除去**: 同名の補助金がある場合、高スコアを採用
2. **スコア順ソート**: 降順（高→低）
3. **上位4件選択**: `.slice(0, 4)`

## デバッグ確認方法

### URL設定
```
http://localhost:3333/phase1?debug=true
```

### コンソール出力内容
- 回答データ（responses）
- 各判定ステップのログ
- 推奨結果（重複除去前）
- 最終結果（重複除去後）

### UI表示
- 回答内容のJSON表示
- コンソール確認の案内

## 確実性の保証

✅ **全ての推奨ルートがマップ化済み**
✅ **重複チェックロジックが明確**  
✅ **スコア計算が透明化**
✅ **デバッグ機能で検証可能**
✅ **テストケースで網羅的に検証**

これにより、どの選択肢の組み合わせでも、推奨結果の根拠と過程を完全に追跡・検証できる。