# 補助金システム 定期保守運用チェックリスト

## 📅 実行指示: 「定期保守を実行してください」

このチェックリストに従って、**必ず全項目を順番通りに実行**してください。

---

## 🔄 Phase 1: システム状態確認 (5分)

### ✅ 1-1. 現在の稼働状況確認
```bash
cd /Users/r9a/exp/attg/backend
```

- [ ] **フロントエンドサーバー稼働確認**
  ```bash
  # ブラウザで http://localhost:3000 にアクセス
  # → 正常に表示されることを確認
  ```

- [ ] **バックエンドAPI稼働確認**  
  ```bash
  # ブラウザで http://localhost:8000/docs にアクセス
  # → FastAPI Swagger画面が表示されることを確認
  ```

- [ ] **最新バックアップ確認**
  ```bash
  ls -la *.backup.* | head -5
  # → 直近のバックアップファイル存在確認
  ```

---

## 🔍 Phase 2: 情報更新実行 (15分)

### ✅ 2-1. LLM更新プロンプト生成
```bash
python3 update_prompt_generator.py
```
- [ ] 実行結果: `✅ llm_update_prompt.mdを更新しました` 表示確認
- [ ] エラーなく完了したか確認

### ✅ 2-2. 補助金情報調査実行
```bash
# llm_update_prompt.mdの内容をLLMに投入して調査実行
cat llm_update_prompt.md
```

**LLM (Claude等) での作業:**
- [ ] `llm_update_prompt.md`の全内容をLLMに貼り付け
- [ ] LLMが6つの補助金すべてを調査したか確認
- [ ] 調査結果がYAML形式で出力されたか確認  
- [ ] 結果を `research_YYYY-MM-DD.yaml` として保存

### ✅ 2-3. 調査結果の自動反映
```bash
python3 update_subsidies_from_research.py
# プロンプトで調査結果YAMLファイルのパス入力
```
- [ ] バックアップ作成完了メッセージ確認
- [ ] `subsidies.yaml` 更新完了確認  
- [ ] `version_history.yaml` 更新完了確認
- [ ] エラーなく全て完了したか確認

---

## 🎯 Phase 3: 動作検証 (10分)

### ✅ 3-1. フロントエンド表示確認
```bash
# ブラウザで各補助金申請画面を確認
```
- [ ] **中小企業新事業進出補助金**: 募集期間が最新情報に更新されているか
- [ ] **アトツギ甲子園**: 第6回大会情報が正しく表示されているか  
- [ ] **ものづくり補助金**: 最新の締切分情報が反映されているか
- [ ] **期限切れ警告**: 終了した補助金で赤色警告が表示されるか
- [ ] **スマホ表示**: モバイル画面でも正常表示されるか

### ✅ 3-2. API動作確認
```bash
# 各補助金のメタデータAPI確認
curl http://localhost:8000/subsidies/shinjigyo_shinshutsu/metadata
curl http://localhost:8000/subsidies/atotsugi/metadata
```
- [ ] 各APIが正常にJSON応答を返すか確認
- [ ] `application_period`情報が含まれているか確認

---

## 📊 Phase 4: ログ・履歴確認 (5分)

### ✅ 4-1. 更新履歴記録確認
```bash
grep -A 3 "$(date +%Y-%m-%d)" version_history.yaml
```
- [ ] 本日の更新記録が正しく記録されているか確認
- [ ] 各補助金のバージョンが適切にインクリメントされているか確認

### ✅ 4-2. エラーログ確認
```bash
# バックエンドサーバーのログ確認
# エラーや警告がないか確認
```
- [ ] システムエラーログに異常がないか確認
- [ ] 未処理のエラーがないか確認

---

## 🔧 Phase 5: 次回準備 (3分)

### ✅ 5-1. 次回更新準備
```bash
# 次回の更新予定日を記録
echo "次回定期更新予定: $(date -d '+14 days' +%Y-%m-%d)" >> maintenance_log.txt
```
- [ ] 次回更新予定日を記録
- [ ] 特別な注意事項があれば記録

### ✅ 5-2. システム最終確認
- [ ] 全ての変更が適切に保存されているか確認
- [ ] バックアップファイルが正常に作成されているか確認
- [ ] システム全体が安定稼働しているか確認

---

## 📋 実行完了報告フォーマット

```
■ 定期保守実行報告 - YYYY年MM月DD日

【Phase 1: システム状態確認】✅
- フロントエンド稼働: 正常
- バックエンド稼働: 正常  
- バックアップ状況: 正常

【Phase 2: 情報更新実行】✅
- プロンプト生成: 正常完了
- LLM調査実行: X件の補助金を調査完了
- 結果反映: X件の補助金情報を更新

【Phase 3: 動作検証】✅
- フロントエンド表示: 全補助金で最新情報表示確認
- API動作: 全エンドポイント正常応答確認

【Phase 4: ログ・履歴確認】✅  
- 更新履歴: 適切に記録済み
- エラーログ: 異常なし

【Phase 5: 次回準備】✅
- 次回更新予定: YYYY-MM-DD
- 特記事項: なし

■ 保守作業完了: 全システム正常稼働中
```

---

## ⚠️ 緊急時対応

**エラーが発生した場合:**
1. 該当Phaseの作業を中断
2. バックアップからの復旧手順を実行
3. 管理者（羽生田大陸）に連絡
4. エラー詳細をメンテナンスログに記録

**連絡先:** 株式会社羽生田鉄工所 羽生田大陸

---

## 📝 重要な注意事項

1. **必ず順番通りに実行**: Phaseを飛ばさず、チェックボックスを確認しながら進行
2. **エラー時は即停止**: 異常を検知したら次のPhaseに進まない
3. **バックアップ必須**: 重要な変更前は必ずバックアップを確認
4. **記録を残す**: 実行結果は必ず記録し、トレーサビリティを確保

**このチェックリストに従うことで、システムの安定稼働と情報の正確性を維持できます。**